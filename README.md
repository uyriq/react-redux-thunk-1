## task 1/5

Сейчас корзина товаров работает с захардкоженными данными. На практике такого не бывает и, как правило, данные запрашиваются с бэкенда. Мы подготовили уже знакомый вам файл `fakeApi.js`. В этом задании попробуем забирать данные оттуда с использованием усилителя `redux-thunk`.

Сначала возьмём в работу самый простой запрос, который будет возвращать список товаров корзины. Для этого нужно подготовить усилитель в директории `actions` файла `cart.js`. Импортируйте запрос `getItemsRequest` и расширьте тип экшенов. Добавьте три экшена:

-   `GET_ITEMS_REQUEST` — отображается, если запрос отправлен.
-   `GET_ITEMS_SUCCESS` — показывается в случае успеха, когда запрос выполнен и данные получены.
-   `GET_ITEMS_FAILED` — используется в случае ошибки.

После создайте в том же файле асинхронный экшен `getItems`. В самом начале отправляйте экшен `GET_ITEMS_REQUEST`. После экшена — запрос с использованием ранее импортированной функции `getItemsRequest`. Если ответ пришёл и свойство `success` равно `true` — отправьте в редьюсер экшен `GET_ITEMS_SUCCESS`, а в качестве данных укажите свойство `items` со значением `res.data`. В противном случае — `GET_ITEMS_FAILED`.

Это всё, что нужно сделать в файле экшенов. Остаётся только обработать каждый из созданных. Для этого перейдите в редьюсер `cart.js` директории `reducers` и расширьте начальное состояние:

-   в начальном состоянии укажите значение `items` равное пустому массиву;
-   добавьте поля `itemsRequest` и `itemsFailed` со значением `false` по умолчанию.

После этого импортируйте типы экшенов, созданные до этого. В редьюсере `cartReducer` обработайте действия таким образом:

-   `GET_ITEMS_REQUEST` — запрос отправ`лен, а значит можно отобразить прелоудер. Поле `itemsRequest`приобретает значение`true`.
-   `GET_ITEMS_SUCCESS` — запрос прошёл успешно. Поля `itemsRequest` и `itemsFailed` принимают значение `false`, а в состояние `items` попадает массив `action.items`.
-   `GET_ITEMS_FAILED` — всё плохо. Но не у нас. Поле `itemsFailed` приобретает значение `true`, а `itemsRequest` — `false`.

## task 2/5

В хранилище корзины ещё остались блоки кода, которые нужно привязать к бэкенду. Это функциональность промокодов и рекомендуемые товары. Начнём с последних, потому что работа с ними очень похожа на обработку обычных товаров.

Подготовьте усилитель в файле `cart.js` директории `actions`. Импортируйте запрос `getRecommendedItemsRequest` и расширьте тип экшенов. Добавьте три экшена:

-   `GET_RECOMMENDED_ITEMS_REQUEST` — отображается, если запрос отправлен.
-   `GET_RECOMMENDED_ITEMS_SUCCESS` — показывается в случае успеха, когда запрос выполнен и товары получены.
-   `GET_RECOMMENDED_ITEMS_FAILED` — используется в случае ошибки при выполнении запроса.

Затем в том же файле создайте усилитель `getRecommendedItems`. Логика этого усилителя полностью дублирует логику `getItems` за тем исключением, что отличаются типы экшенов.

После этого в редьюсере `cart.js` директории `reducers` расширьте начальное состояние:

-   в начальном состоянии укажите значение `recommendedItems` равное пустому массиву;
-   добавьте поля `recommendedItemsRequest` и `recommendedItemsFailed` со значением `false` по умолчанию.

Импортируйте созданные до этого типы экшенов. В редьюсере `cartReducer` обработайте действия следующим образом:

-   `GET_RECOMMENDED_ITEMS_REQUEST` — запрос отправлен. Поле `recommendedItemsRequest` приобретает значение `true`.
-   `GET_RECOMMENDED_ITEMS_SUCCESS` — запрос прошёл успешно. Поля `recommendedItemsRequest` и `recommendedItemsFailed` приобретают значение `false`, а в состояние `recommendedItems` попадает массив `action.items`.
-   `GET_RECOMMENDED_ITEMS_FAILED` — произошла ошибка при выполнении запроса. Поле `recommendedItemsFailed` приобретает значение `true`, а `recommendedItemsRequest` — `false`.

Не поверите, но следующим шагом предстоит сделать то же самое для применения промокодов. Попытайтесь реализовать экшены и редьюсер самостоятельно, а мы предоставим вам название переменных и особенности работы с промокодами.

Типы экшенов:

-   `APPLY_PROMO_FAILED` — ошибка активации промокода,
-   `APPLY_PROMO_REQUEST` — произошёл запрос,
-   `APPLY_PROMO_SUCCESS` — запрос выполнился успешно. В этом случае из усилителя требуется отправить поле `value` со значением `{ ...res, code }`.

Название усилителя — `applyPromo`. А запрос на активацию промокода из файла `fakeApi.js` — `applyPromoCodeRequest`.

В редьюсере расширьте начальное состояние:

-   `promoRequest` — поле для хранения состояния запроса,
-   `promoFailed` — произошла ошибка при выполнении запроса.

В случае возникновения ошибки при применении промокода обнулите текущие данные о скидке и названии промокода в редьюсере:

```jsx

promoDiscount: null,
promoCode: ''

```

Если же промокод применился успешно, возьмите данные из ответа и добавьте их, как делали с полями выше:

```jsx

promoCode: action.value.code,
promoDiscount: action.value.discount

```

Когда всё будет готово — удалите файл `initialData.js` и все импорты данных из этого файла в редьюсере `cart`.

Обычно мы так не делаем (это не точно), но в этом задании готовы поделиться усилителем `applyPromo`:

```jsx
export function applyPromo(code) {
    return function (dispatch) {
        dispatch({
            type: APPLY_PROMO_REQUEST,
        })
        applyPromoCodeRequest(code).then((res) => {
            if (res && res.success) {
                dispatch({
                    type: APPLY_PROMO_SUCCESS,
                    value: { ...res, code },
                })
            } else {
                dispatch({
                    type: APPLY_PROMO_FAILED,
                })
            }
        })
    }
}
```

Пользуйтесь на здоровье, но не забывайте проверять код на наличие нужных импортов.

## task 3/5

Самое время подключить Redux Devtools и усилители к хранилищу. Для этого в корневом файле `index.js ` создайте переменную `composeEnhancers` и проверьте, есть ли в ней объекты `window ` и `window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__`. Если всё хорошо, вызовите расширение с пустым набором опций. В противном случае — верните compose.
После этого создайте расширитель хранилища: передайте вспомогательную функцию `applyMiddleware` в `composeEnhancers`. В завершении — передайте созданный расширитель в функцию ` createStore`.
Если конструкция по добавлению Redux Devtools до сих пор выглядит пугающе, вот готовое решение (чтобы было не так страшно, можете перенести код с закрытыми глазами):

```JS
const composeEnhancers =
  typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__
    ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})
    : compose;
```
